# 암호학과 어카운트
블록체인에서 데이터는 암호화 표준에 의해 저장, 전송된다. 이러한 암호화 표준은 어카운트 생성, 트랜잭션 전송 승인(Signature, 혹은 서명이라고 하는데), 트랜잭션 데이터 저장, 블록 저장과 같이 다양한 영역에서 활용된다.

## 0. 공개 키 암호화 
공개 키 암호화 알고리즘은 공개 키(public key, 혹은 퍼블릭 키)와 비공개 키(private key, 혹은 프라이빗 키)를 통해 데이터를 암호화하고 복호화한다. 이는 비대칭 키 암호화라고도 알려져 있다. 공개 키는 누구에게나 공유해도 되지만 비공개 키는 누구에게도 알려지면 안된다. 암호 통신 방식으로는 디지털 서명과 암호/복호 통신 방식이 존재한다.

### 디지털 서명
- 서명: 전송자(Sender)는 자신의 비공개 키 로 메시지에 서명한다. 이 서명은 전송자의 공개 키를 가진 사람 누구나 검증할 수 있다.
- 검증: 수신자(Receiver)는 전송자의 공개 키를 사용하여 서명을 검증한다. 이를 통해 메시지가 전송자로부터 왔음을 확인할 수 있다.

### 암호 / 복호 통신
- 암호화: 전송자는 수신자의 공개 키로 메시지를 암호화한다. 공개 키로 암호화된 메시지는 수신자의 비공개 키로만 복호화할 수 있다.
- 복호화: 수신자는 자신의 비공개 키로 암호화된 메시지를 복호화한다. 이를 통해 메시지를 안전하게 전달받을 수 있다.


### 블록체인 사용 사례
블록체인에서는 공개키 암호화가 다양한 방식으로 사용된다:
- 트랜잭션 서명 및 검증: 자신의 비공개 키로 트랜잭션에 디지털 서명(sign)을 하고, 네트워크 다른 노드들은 사용자의 공개 키를 사용하여 서명을 검증(verify)한다. 
- 주소(address) 생성: 공개 키를 통해 파생된 주쇼를 생성하여 공개한다. 다른 사용자는 해당 유저의 주소를 참고하여 트랜잰션을 전송할 수 있다. 

### 공개 키 암호화 종류
공개 키 암호화 알고리즘은 여러가지 종류가 있다. 그 중에서 SSL/TLS 인증서 암호화에서도 사용되는 RSA와 ECC에 대해서 알아보자. 

#### 1. RSA (Rivest-Shamir-Adleman)
RSA는 1977년 Ron Rivest, Adi Shamir 및 Leonard Adleman에 의해 발명된 소인수분해의 어려움을 기반으로 하는 공개키 암호화 알고리즘이다. 엄청난 큰 두 소수를 곱하여 공개 키를 만드는 방법으르로 소수 값을 모르면 메시지를 해독할 수 없다는 것이 주요 포인트이다. 전통적인 공개키 암호화 알고리즘으로 검증되어 널리 사용되고 있다. 

RSA를 채택하는 이유는 간단한 수학적 원리를 기반으로 하며 ECC에 비해 더 빠르게 실행될 수 있기 때문이다. ECC가 무엇인지는 잠시 후에 알아보도록 하자. 다만 단순한만큼 높은 보안 수준을 위해서 2048비트 이상의 Key size가 필요하다는 단점을 가지고 있다. 컴퓨터 계산 능력이 나날이 발전함에 따라 해당 취약점을 마냥 무시할 수는 없다. 

#### 2. ECC (Elliptic Curve Cryptography)
타원 곡선 암호화(ECC)의 역사는 닐 코블리츠(Neal Koblitz)와 빅터 S. 밀러(Victor S. Miller)라는 수학자 두 명이 암호화에서 1985년에 타원 곡선의 사용을 제안했다. 이는 유한 필드에 대한 타원 곡선의 대수적 구조를 사용하는 비대칭 암호화 알고리즘이다. 이 암호화 방법은 그래프에서 타원 곡선을 생성하는 방정식에 의해 주어진 수학적 문제에 대한 알려진 해결책이 없기 때문에 해독하기가 더 어렵다고 알려져 있다. 

따라서 ECC는 RSA에 비해 비교적 작은 Key Size로도 더 높은 보안을 제공할 수 있다. 예를 들어, 256비트의 ECC 키는 15360비트의 RSA 키와 유사한 보안 수준을 제공한다고 한다. 많은 전문가들은 2030년이 되면 RSA가 더 이상 사용되지 않을 것이라고 믿고 있다. 반면에 ECC는 성숙 단계에 있으며 많은 사용자가 사용하기 시작했다. 디지털 서명을 통해 트랜잭션을 사용하는 블록체인 분야 또한 ECC를 주로 채택하여 사용하고 있고, Cosmos SDK 또한 ECC를 사용하고 있다.

## 1. 어카운트
어카운트는 공개 키 암호화 알고리즘에서 사용하는 공개 키와 비공개 키를 담은 객체를 말한다. 앞서 말했다시피 공개 키는 공개해도 안전한 사용자의 고유 식별자(identifier)를 나타낸다. 비공개 키는 사용자가 직접 서명했음을 다른 사람에게 증명할 때 사용하므로 기밀로 관리해야 한다. 
- 공개 키는 애플리케이션에서 사용자를 식별하는 데 사용되는 다양한 주소를 생성하기 위해 파생될 수 있다.
- 주소는 메시지 발신자를 식별하기 위해 메시지와도 연결된다. 
- 비공개 키는 디지털 서명을 생성하는 데 사용되어 비공개 키와 연결된 주소가 특정 메시지를 승인했음을 증명한다.

### HD(Hierarchical Deterministic) 지갑(Wallets)
HD 지갑이란 하나의 키로 여러 계정을 생성할 때 사용되는 계정 생성 방식으로 하나의 비공개 키로 여러 공개 키를 통제하는 계정(지갑)을 만들 때 사용된다. HD 지갑은 비트코인의 [BIP32](https://en.bitcoin.it/wiki/BIP_0032) 문서에 의거하여 만들어진다.
- 블록체인은 일반적으로 사용자 계정의 원장을 유지하며 사용자 인증을 위해 공개 키 암호화를 사용한다. 트랜잭션을 실행하려면 자신의 공개 키와 비공개 키에 대한 정보가 필요하다. 
- 지갑으로 알려진 클라이언트 앱은 새로운 키 쌍 (public key, private key)을 생성하고 저장하는 방법과 트랜잭션 생성, 메시지 서명, 애플리케이션과의 상호 작용, 블록체인과의 통신과 같은 기본 서비스를 제공한다. 

<p align="center">
  <img width="460" height="300" src="https://github.com/bitcoin/bips/blob/master/bip-0032/derivation.png?raw=true">
</p>

HD 지갑의 모든 키를 통제하는 최초의 문구를 시드라고 한다. BIP39 이후, 이 초기 시드는 대부분 표준화된 사전에서 가져온 니모닉이라고 하는 12개 또는 24개의 단어로 생성된다. 니모닉은 결정론적이기 때문에 모든 키 쌍을 니모닉으로 재구성할 수 있다. 그래서 니모닉만 안전하게 보관하면 된다. 하나의 니모닉에서 생성할 수 있는 키 쌍의 수에는 실질적인 상한선이 없다. [BIP44](https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki) 파생(derivation) 경로에서 가져온 입력은 하나의 니모닉을 사용하여 모든 블록체인의 키 쌍을 생성하는 데 사용되기 때문에 "Hierarchical Deterministic(HD, 혹은 계층 결정)"라는 이름이 지어졌다. 

